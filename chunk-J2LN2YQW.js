import{a as de,c as _,d as me,e as fe,g as R,h as ue,i as he,j as ge,l as ve,m as Se,n as we,o as ye}from"./chunk-HQMHUBNU.js";import"./chunk-S2OBTSZA.js";import{a as U,c as xe}from"./chunk-OROPRCOW.js";import{a as M,b as H}from"./chunk-MJEQESGC.js";import{a as D}from"./chunk-XOKX2JYT.js";import{$ as y,A as W,B as T,D as ee,G as w,H as b,I as te,K as ie,Pa as ae,R as oe,T as ne,Ta as ce,W as c,X as f,Y as k,Z as re,a as G,b as B,ba as g,d as $,fa as x,ga as se,ha as le,i as J,ia as l,ib as K,j,ja as a,ka as d,kb as pe,l as X,n as q,p as Z,pa as F,qa as v,ta as m,ua as P,va as I,w as N,wa as O,x as Q}from"./chunk-GKZ3XEYF.js";function We(t,e){if(t&1&&m(0),t&2){let n=v();I(" ",n.user.company_name," ")}}function ke(t,e){if(t&1&&m(0),t&2){let n=v();O(" ",n.user.first_name," ",n.user.last_name," ")}}function Ke(t,e){if(t&1&&m(0),t&2){let n=v();I(" ",n.user.description," ")}}function Re(t,e){if(t&1&&m(0),t&2){let n=v();I(" ",n.user.title," ")}}function ze(t,e){if(t&1&&m(0),t&2){let n=v();I(" ",n.user.title," ")}}var Te=(()=>{let e=class e{constructor(i){this.users=i}};e.\u0275fac=function(o){return new(o||e)(f(D))},e.\u0275cmp=w({type:e,selectors:[["app-profile-overview"]],inputs:{user:"user"},decls:9,vars:3,consts:[[1,"bg-white","p-4","rounded-lg","shadow","text-center"],["alt","Profile","height","80","width","80",1,"rounded-full","mx-auto","mb-4",3,"appSrc"],[1,"text-xl","font-semibold"],[1,"text-sm","text-gray-500"]],template:function(o,r){o&1&&(l(0,"div",0),d(1,"img",1),l(2,"h3",2),y(3,We,1,1)(4,ke,1,2),a(),l(5,"p",3),y(6,Ke,1,1)(7,Re,1,1)(8,ze,1,1),a()()),o&2&&(c(),g("appSrc",r.user.imageName),c(2),x(3,r.users.isCompany(r.user)?3:r.users.isJobseeker(r.user)||r.users.isAdmin(r.user)?4:-1),c(3),x(6,r.users.isCompany(r.user)?6:r.users.isJobseeker(r.user)?7:r.users.isAdmin(r.user)?8:-1))},dependencies:[U]});let t=e;return t})();var E=(()=>{let e=class e{constructor(i){this.http=i,this.api=pe.hostUrl+"/api/social"}getPosts(i,o,r){return new Promise((s,p)=>this.http.get(this.api+"/posts",{params:{page:i.toString(),size:o.toString(),sort:r}}).subscribe({next:h=>s(h),error:h=>p}))}getPost(i){return new Promise((o,r)=>{this.http.get(this.api+"/posts/"+i).subscribe({next:s=>o(s),error:s=>r(s)})})}createPost(i){return new Promise((o,r)=>{this.http.post(this.api+"/posts",i).subscribe({next:s=>o(s),error:s=>r(s)})})}};e.\u0275fac=function(o){return new(o||e)(ee(ce))},e.\u0275prov=W({token:e,factory:e.\u0275fac});let t=e;return t})();function Ye(t,e){if(t&1&&d(0,"img",11),t&2){let n=v();g("src",n.imagePreview,oe)}}var Pe=(()=>{let e=class e{constructor(i,o,r,s){this.utils=i,this.fb=o,this.forms=r,this.posts=s,this.content=new R("",[_.required,_.minLength(5),_.maxLength(500),_.pattern(/^[a-zA-Z0-9\s]+$/)]),this.image=new R(null),this.postForm=this.fb.group({content:this.content,image:this.image})}onImagePicked(i){let o=i.target,r=o.files[0];if(o&&r){let s=new Image;s.src=window.URL.createObjectURL(r),s.onload=()=>{try{let p=r.size/1024,h=s.width>500||s.height>500||s.width<100||s.height<100,u=p>3e3;if(h)throw new Error("Les dimensions de l'image doivent \xEAtre comprises entre 100x100 et 500x500");if(u)throw new Error("La taille de l'image ne doit pas d\xE9passer 3Mo");let S=new FileReader;S.onload=()=>this.imagePreview=S.result,S.readAsDataURL(r),this.postForm.patchValue({image:r})}catch(p){this.utils.alert(p.message,M.ERROR)}}}}submitPost(){return $(this,null,function*(){return new Promise(i=>{setTimeout(()=>{this.postForm.reset(),i(!0)},2e3)})})}};e.\u0275fac=function(o){return new(o||e)(f(H),f(ve),f(ye),f(E))},e.\u0275cmp=w({type:e,selectors:[["app-post-form"]],decls:12,vars:3,consts:[[1,"bg-white","p-4","rounded-lg","shadow-md","w-full","mb-4",3,"formGroup","ngSubmit"],[1,"font-semibold","mb-2"],[1,"mb-4"],["name","content","placeholder","Quoi de neuf ?",1,"textarea","w-full","mb-3","focus:h-40",3,"formControl"],["class","w-52 h-52 rounded-lg mx-auto my-2","alt","Uploaded Image",3,"src"],[1,"flex","justify-end","space-x-2","text-gray-400"],["for","imageUpload",1,"flex","btn","btn-ghost","btn-circle","cursor-pointer"],[1,"bi","bi-camera","text-xl"],["type","file","name","image","id","imageUpload",1,"hidden",3,"change"],["type","submit",1,"btn","btn-primary","btn-circle"],[1,"bi","bi-send-fill","text-lg"],["alt","Uploaded Image",1,"w-52","h-52","rounded-lg","mx-auto","my-2",3,"src"]],template:function(o,r){o&1&&(l(0,"form",0),F("ngSubmit",function(){return r.submitPost()}),l(1,"h1",1),m(2,"Nouvelle publication"),a(),d(3,"hr",2)(4,"textarea",3),y(5,Ye,1,1,"img",4),l(6,"div",5)(7,"label",6),d(8,"i",7),l(9,"input",8),F("change",function(p){return r.onImagePicked(p)}),a()(),l(10,"button",9),d(11,"i",10),a()()()),o&2&&(g("formGroup",r.postForm),c(4),g("formControl",r.content),c(),x(5,r.imagePreview?5:-1))},dependencies:[ue,de,me,fe,he,ge]});let t=e;return t})();function Ge(t,e,n,i){let o=window&&!!window.document&&window.document.documentElement,r=o&&e?window:n;if(t&&(r=t&&o&&typeof t=="string"?Be(t,n.nativeElement,i):t,!r))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return r}function Be(t,e,n){return(n?window.document:e).querySelector(t)}function z(t){return t&&!t.firstChange}function $e(){return typeof window<"u"}var Je={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},Xe={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"},L=class{constructor(e=!0){this.vertical=e,this.propsMap=e?Je:Xe}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}};function qe(t,e,n){return!!(t&&e||!n&&e)}function Ze({windowElement:t,axis:e}){return Qe({axis:e,isWindow:et(t)},t)}function Qe(t,e){let n=t.isWindow||e&&!e.nativeElement?e:e.nativeElement;return B(G({},t),{container:n})}function et(t){return["Window","global"].some(n=>Object.prototype.toString.call(t).includes(n))}function V(t,e){return t?e.document.documentElement:null}function De(t,e){let n=ot(e);return e.isWindow?tt(n,t,e):it(n,t,e)}function tt(t,e,n){let{axis:i,container:o,isWindow:r}=n,{offsetHeightKey:s,clientHeightKey:p}=Ee(i),h=t+Ie(V(r,o),i,r),u=Fe(e.nativeElement,r,s,p),S=nt(e.nativeElement,i,r)+u;return{height:t,scrolled:h,totalToScroll:S,isWindow:r}}function it(t,e,n){let{axis:i,container:o}=n,r=o[i.scrollTopKey()],s=o[i.scrollHeightKey()];return{height:t,scrolled:r,totalToScroll:s,isWindow:!1}}function Ee(t){return{offsetHeightKey:t.offsetHeightKey(),clientHeightKey:t.clientHeightKey()}}function ot({container:t,isWindow:e,axis:n}){let{offsetHeightKey:i,clientHeightKey:o}=Ee(n);return Fe(t,e,i,o)}function Fe(t,e,n,i){if(isNaN(t[n])){let o=V(e,t);return o?o[i]:0}else return t[n]}function nt(t,e,n){let i=e.topKey();if(t.getBoundingClientRect)return t.getBoundingClientRect()[i]+Ie(t,e,n)}function Ie(t,e,n){let i=e.pageYOffsetKey(),o=e.scrollTopKey(),r=e.offsetTopKey();return isNaN(window.pageYOffset)?V(n,t)[o]:t.ownerDocument?t.ownerDocument.defaultView[i]:t[r]}function rt(t,e={down:0,up:0},n){let i,o;if(t.totalToScroll<=0)return!1;let r=t.isWindow?t.scrolled:t.height+t.scrolled;if(n)i=(t.totalToScroll-r)/t.totalToScroll,o=(e?.down?e.down:0)/10;else{let p=t.scrolled+(t.totalToScroll-r);i=t.scrolled/p,o=(e?.up?e.up:0)/10}return i<=o}function st(t,e){return t<e.scrolled}function lt(t,e,n){let i=st(t,e);return{fire:rt(e,n,i),scrollDown:i}}var A=class{constructor(e){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},Object.assign(this,e)}updateScrollPosition(e){return this.lastScrollPosition=e}updateTotalToScroll(e){this.lastTotalToScroll!==e&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=e)}updateScroll(e,n){this.updateScrollPosition(e),this.updateTotalToScroll(n)}updateTriggeredFlag(e,n){n?this.triggered.down=e:this.triggered.up=e}isTriggeredScroll(e,n){return n?this.triggered.down===e:this.triggered.up===e}};function at(t){let{scrollContainer:e,scrollWindow:n,element:i,fromRoot:o}=t,r=Ze({axis:new L(!t.horizontal),windowElement:Ge(e,n,i,o)}),s=new A({totalToScroll:De(i,r).totalToScroll}),p={container:r.container,throttle:t.throttle},h={up:t.upDistance,down:t.downDistance};return ct(p).pipe(X(()=>J(De(i,r))),j(u=>pt(s.lastScrollPosition,u,h)),N(({stats:u})=>s.updateScroll(u.scrolled,u.totalToScroll)),Z(({fire:u,scrollDown:S,stats:{totalToScroll:je}})=>qe(t.alwaysCallback,u,s.isTriggeredScroll(je,S))),N(({scrollDown:u,stats:{totalToScroll:S}})=>{s.updateTriggeredFlag(S,u)}),j(dt))}function ct(t){let e=q(t.container,"scroll");return t.throttle&&(e=e.pipe(Q(t.throttle,void 0,{leading:!0,trailing:!0}))),e}function pt(t,e,n){let{scrollDown:i,fire:o}=lt(t,e,n);return{scrollDown:i,fire:o,stats:e}}var Y={DOWN:"[NGX_ISE] DOWN",UP:"[NGX_ISE] UP"};function dt(t){let{scrollDown:e,stats:{scrolled:n}}=t;return{type:e?Y.DOWN:Y.UP,payload:{currentScrollPosition:n}}}var _e=(()=>{let e=class e{constructor(i,o){this.element=i,this.zone=o,this.scrolled=new k,this.scrolledUp=new k,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:i,infiniteScrollDisabled:o,infiniteScrollDistance:r}){let s=z(i),p=z(o),h=z(r),u=!p&&!this.infiniteScrollDisabled||p&&!o.currentValue||h;(s||p||h)&&(this.destroyScroller(),u&&this.setup())}setup(){$e()&&this.zone.runOutsideAngular(()=>{this.disposeScroller=at({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(i=>this.handleOnScroll(i))})}handleOnScroll({type:i,payload:o}){let r=i===Y.DOWN?this.scrolled:this.scrolledUp;mt(r)&&this.zone.run(()=>r.emit(o))}ngOnDestroy(){this.destroyScroller()}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}};e.\u0275fac=function(o){return new(o||e)(f(ne),f(re))},e.\u0275dir=te({type:e,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[ie]});let t=e;return t})();function mt(t){return t.observed??t.observers.length>0}var Oe=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=b({type:e}),e.\u0275inj=T({});let t=e;return t})();var ut=(t,e)=>e.post_id;function ht(t,e){if(t&1&&(l(0,"h3",14),m(1),a(),l(2,"span",5),m(3),a()),t&2){let n=v().$implicit;c(),O("",n.profile.user.first_name," ",n.profile.user.last_name,""),c(2),P(n.profile.user.title)}}function gt(t,e){if(t&1&&(l(0,"h3",14),m(1),a(),l(2,"span",5),m(3),a()),t&2){let n=v().$implicit;c(),P(n.profile.user.company_name),c(2),P(n.profile.user.sector)}}function vt(t,e){t&1&&(l(0,"div",15)(1,"div",16),d(2,"div",17),l(3,"div",18),d(4,"div",19)(5,"div",20),a()(),d(6,"div",21),a())}function St(t,e){if(t&1&&(l(0,"div",1)(1,"div",2),d(2,"img",3),l(3,"div",4),y(4,ht,4,3)(5,gt,4,2),l(6,"p",5),m(7),a(),l(8,"p",6),m(9),a(),l(10,"div",7),d(11,"img",8),a()()(),l(12,"div",9)(13,"div",10)(14,"span",11),d(15,"i",12),a(),l(16,"span",11),m(17,"Commenter"),a(),l(18,"span",11),m(19,"Envoyer"),a()()()(),y(20,vt,7,0,"div",13)),t&2){let n=e.$implicit,i=v();c(2),g("appSrc",n.profile.user.imageName),c(2),x(4,i.users.isJobseeker(n.profile.user)||i.users.isAdmin(n.profile.user)?4:i.users.isCompany(n.profile.user)?5:-1),c(3),P(i.utils.formatDate(n.created,!0)),c(2),P(n.description),c(2),g("appSrc",n.imageName),c(9),x(20,i.isLoading?20:-1)}}var Me=(()=>{let e=class e{constructor(i,o,r){this.postsService=i,this.utils=o,this.users=r,this.posts=[],this.current_page=0,this.size=10,this.isLoading=!1,this.loadPosts()}loadPosts(){this.isLoading=!0,this.postsService.getPosts(this.current_page,this.size,"created").then(i=>{this.posts=this.posts.concat(i.content),this.current_page++,this.isLoading=!1}).catch(i=>{this.utils.alert("Error loading posts",M.ERROR),this.isLoading=!1})}onScroll(){this.isLoading||this.loadPosts()}};e.\u0275fac=function(o){return new(o||e)(f(E),f(H),f(D))},e.\u0275cmp=w({type:e,selectors:[["app-posts-feed"]],decls:3,vars:2,consts:[["infiniteScroll","",3,"infiniteScrollDistance","infiniteScrollThrottle","scrolled"],[1,"bg-white","p-4","rounded-lg","shadow","mb-2"],[1,"flex","items-start","mb-2"],["alt","Profile",1,"w-12","h-12","rounded-full","mr-4",3,"appSrc"],[1,"w-full"],[1,"text-sm","text-gray-500","leading-none"],[1,"my-4"],[1,"relative","my-2"],["alt","Post image",1,"w-full","h-full","object-cover",3,"appSrc"],[1,"mt-4","flex","justify-between","text-gray-600","text-sm"],[1,"flex","space-x-2"],[1,"cursor-pointer"],[1,"bi","bi-hand-thumbs-up-fill"],["class","flex w-full flex-col gap-4"],[1,"text-lg","font-semibold","leading-none"],[1,"flex","w-full","flex-col","gap-4"],[1,"flex","items-center","gap-4"],[1,"skeleton","h-16","w-16","shrink-0","rounded-full"],[1,"flex","flex-col","gap-4"],[1,"skeleton","h-4","w-20"],[1,"skeleton","h-4","w-28"],[1,"skeleton","h-32","w-full"]],template:function(o,r){o&1&&(l(0,"div",0),F("scrolled",function(){return r.onScroll()}),se(1,St,21,6,null,null,ut),a()),o&2&&(g("infiniteScrollDistance",2)("infiniteScrollThrottle",50),c(),le(r.posts))},dependencies:[U,_e]});let t=e;return t})();var He=(()=>{let e=class e{constructor(i){this.users=i}ngOnInit(){this.users.currentUser.subscribe(i=>{i&&(this.user=i)})}};e.\u0275fac=function(o){return new(o||e)(f(D))},e.\u0275cmp=w({type:e,selectors:[["app-feed"]],decls:6,vars:1,consts:[[1,"mx-auto","p-4","flex","gap-6","w-3/4"],[1,"w-3/4"],[1,"w-1/4","space-y-4"],[3,"user"]],template:function(o,r){o&1&&(l(0,"div",0)(1,"div",1),d(2,"app-post-form")(3,"app-posts-feed"),a(),l(4,"div",2),d(5,"app-profile-overview",3),a()()),o&2&&(c(5),g("user",r.user))},dependencies:[Te,Pe,Me]});let t=e;return t})();var yt=[{path:"",children:[{path:"",redirectTo:"feed",pathMatch:"full"},{path:"feed",component:He,title:"Fil d'actualit\xE9 - LinkedOut"}]}],Ue=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=b({type:e}),e.\u0275inj=T({imports:[K.forChild(yt),K]});let t=e;return t})();var oi=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=b({type:e}),e.\u0275inj=T({providers:[E],imports:[ae,Ue,Se,we,xe,Oe]});let t=e;return t})();export{oi as SocialModule};
