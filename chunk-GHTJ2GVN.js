import{b as n}from"./chunk-BU24F6HC.js";import{Qa as c,g as u,i as o,n as h,s as a,w as p,z as l}from"./chunk-WGWKOD3E.js";var g=(()=>{let r=class r{constructor(t){this.http=t,this.userSubject=new u(null),this.url=n.hostUrl+"/api/auth"}get user(){return this.userSubject.asObservable()}getAuthenticatedUser(){return this.checkAuthStatus().pipe(a(t=>(this.userSubject.next(t),o(t))),h(()=>(this.logout(),o(null))))}login(t){return new Promise((s,e)=>{this.http.post(this.url+"/authenticate",t).subscribe(this.handleResponse(s,e))})}logout(){localStorage.removeItem("token"),this.userSubject.next(null),window.location.reload()}register(t,s){return new Promise((e,b)=>{this.http.post(this.url+"/register/"+s.toLowerCase(),t).subscribe(this.handleResponse(e,b))})}verifyEmail(t){return new Promise((s,e)=>{this.http.get(this.url+"/verify/"+t).subscribe(this.handleResponse(s,e))})}resetPassword(t){return new Promise((s,e)=>{this.http.post(this.url+"/verify/password",t).subscribe(this.handleResponse(s,e))})}requestPasswordReset(t){return new Promise((s,e)=>{this.http.post(this.url+"/reset-password",t).subscribe(this.handleResponse(s,e))})}checkAuthStatus(){return this.http.get(n.hostUrl+"/api/user/status/v2")}handleResponse(t,s){return{next:e=>t(e.response),error:e=>s(e)}}simulateLongRequest(){return new Promise((t,s)=>{this.http.get(this.url+"/sleep",{responseType:"text"}).subscribe({next:e=>t(e),error:e=>s(e)})})}};r.\u0275fac=function(s){return new(s||r)(l(c))},r.\u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();export{g as a};
