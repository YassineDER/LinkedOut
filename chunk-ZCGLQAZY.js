import{Pa as u,g as o,gb as l,i as p,n as m,s as f,w as n,z as a}from"./chunk-JPZ7LBG3.js";var d=function(r){return r.DEFAULT="default",r.SUCCESS="success",r.WARNING="warning",r.ERROR="error",r}(d||{});var h=function(r){return r.DEFAULT="default",r.POST="post",r}(h||{});var k=(()=>{let s=class s{constructor(t){this.http=t,this.alertSubject=new o(null),this.alert$=this.alertSubject.asObservable(),this.ip$=null,this.audio=new Audio}alert(t,e=d.DEFAULT){this.alertSubject.next({message:t,type:e})}playSound(t){let e="";switch(t){case h.DEFAULT:e="assets/sound/notification.wav";break;case h.POST:e="assets/sound/post.wav";break}this.audio.src=e,this.audio.load(),this.audio.play()}formatDate(t){let[e,i,c,b,w,g,S]=t;return new Date(e,i-1,c,b,w,g,S/1e6).toLocaleString()}fetchIp(){return this.http.get("https://api.ipify.org?format=json")}get ip(){return this.ip$}set ip(t){this.ip$=t}};s.\u0275fac=function(e){return new(e||s)(a(u))},s.\u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"});let r=s;return r})();var D=(()=>{let s=class s{constructor(t){this.http=t,this.userSubject=new o(null),this.url=l.hostUrl+"/api/auth"}get user(){return this.userSubject.asObservable()}getAuthenticatedUser(){return this.checkAuthStatus().pipe(f(t=>(this.userSubject.next(t),p(t))),m(()=>(this.logout(),p(null))))}login(t){return new Promise((e,i)=>{this.http.post(this.url+"/authenticate",t).subscribe(this.handleResponse(e,i))})}logout(){localStorage.removeItem("token"),this.userSubject.next(null),window.location.reload()}register(t,e){return new Promise((i,c)=>{this.http.post(this.url+"/register/"+e.toLowerCase(),t).subscribe(this.handleResponse(i,c))})}verifyEmail(t){return new Promise((e,i)=>{this.http.get(this.url+"/verify/"+t).subscribe(this.handleResponse(e,i))})}resetPassword(t){return new Promise((e,i)=>{this.http.post(this.url+"/verify/password",t).subscribe(this.handleResponse(e,i))})}requestPasswordReset(t){return new Promise((e,i)=>{this.http.post(this.url+"/reset-password",t).subscribe(this.handleResponse(e,i))})}checkAuthStatus(){return this.http.get(l.hostUrl+"/api/user/status/v2")}handleResponse(t,e){return{next:i=>t(i.response),error:i=>e(i)}}simulateLongRequest(){return new Promise((t,e)=>{this.http.get(this.url+"/sleep").subscribe(this.handleResponse(t,e))})}};s.\u0275fac=function(e){return new(e||s)(a(u))},s.\u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"});let r=s;return r})();export{d as a,h as b,k as c,D as d};
