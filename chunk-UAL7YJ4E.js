import{a as Ce,c as O,d as ye,e as Te,g as G,h as xe,i as be,j as _e,l as Pe,m as Ee,n as Ie,o as De}from"./chunk-ZK75M5VO.js";import"./chunk-S2OBTSZA.js";import{a as j,c as Fe}from"./chunk-QFCJGY4B.js";import{a as I,b as Se,c as W}from"./chunk-H5WFD6AQ.js";import{a as D}from"./chunk-XOKX2JYT.js";import{$ as y,A as z,B as _,D as ne,G as C,H as P,I as re,K as se,L as le,M as ae,Pa as ge,R as ce,T as pe,Ta as ve,W as c,X as f,Y as H,Z as de,a as $,b as q,ba as g,d as J,fa as T,ga as me,ha as fe,i as Q,ia as l,ib as L,j as K,ja as a,ka as p,kb as we,l as ee,n as te,na as ue,p as ie,pa as x,qa as v,sa as he,ta as d,ua as E,va as M,w as A,wa as N,x as oe}from"./chunk-GKZ3XEYF.js";function Ye(t,e){if(t&1&&d(0),t&2){let n=v();M(" ",n.user.company_name," ")}}function Be(t,e){if(t&1&&d(0),t&2){let n=v();N(" ",n.user.first_name," ",n.user.last_name," ")}}function Ze(t,e){if(t&1&&d(0),t&2){let n=v();M(" ",n.user.description," ")}}function $e(t,e){if(t&1&&d(0),t&2){let n=v();M(" ",n.user.title," ")}}function qe(t,e){if(t&1&&d(0),t&2){let n=v();M(" ",n.user.title," ")}}var Me=(()=>{let e=class e{constructor(i){this.users=i}};e.\u0275fac=function(o){return new(o||e)(f(D))},e.\u0275cmp=C({type:e,selectors:[["app-profile-overview"]],inputs:{user:"user"},decls:9,vars:3,consts:[[1,"bg-white","p-4","rounded-lg","shadow","text-center"],["alt","Profile","height","80","width","80",1,"rounded-full","mx-auto","mb-4",3,"appSrc"],[1,"text-xl","font-semibold"],[1,"text-sm","text-gray-500"]],template:function(o,r){o&1&&(l(0,"div",0),p(1,"img",1),l(2,"h3",2),y(3,Ye,1,1)(4,Be,1,2),a(),l(5,"p",3),y(6,Ze,1,1)(7,$e,1,1)(8,qe,1,1),a()()),o&2&&(c(),g("appSrc",r.user.imageName),c(2),T(3,r.users.isCompany(r.user)?3:r.users.isJobseeker(r.user)||r.users.isAdmin(r.user)?4:-1),c(3),T(6,r.users.isCompany(r.user)?6:r.users.isJobseeker(r.user)?7:r.users.isAdmin(r.user)?8:-1))},dependencies:[j]});let t=e;return t})();var F=(()=>{let e=class e{constructor(i){this.http=i,this.api=we.hostUrl+"/api/social"}getPosts(i,o,r){return new Promise((s,m)=>this.http.get(this.api+"/posts",{params:{page:i.toString(),size:o.toString(),sort:r}}).subscribe({next:h=>s(h),error:h=>m(h)}))}getPost(i){return new Promise((o,r)=>{this.http.get(this.api+"/posts/"+i).subscribe({next:s=>o(s),error:s=>r(s)})})}createPost(i){return new Promise((o,r)=>{this.http.post(this.api+"/posts",i).subscribe({next:s=>o(s),error:s=>r(s)})})}};e.\u0275fac=function(o){return new(o||e)(ne(ve))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})();function et(t,e){if(t&1&&p(0,"img",11),t&2){let n=v();g("src",n.imagePreview,ce)}}var Ne=(()=>{let e=class e{constructor(i,o,r,s){this.utils=i,this.fb=o,this.forms=r,this.posts=s,this.postCreated=new H,this.content=new G("",[O.required,O.minLength(5),O.maxLength(500),O.pattern(/^[a-zA-ZÀ-ÿ0-9\s.,;:!?'"()\-]{5,500}$/)]),this.image=new G(null),this.postForm=this.fb.group({description:this.content,image_b64:this.image})}onImagePicked(i){let u=i.target,S=u.files[0];if(u&&S){let w=new Image;w.src=window.URL.createObjectURL(S),w.onload=()=>{try{let U=S.size/1024,Ge=w.width>2048||w.height>2048||w.width<600||w.height<600,Ve=U>2e3;if(Ge)throw new Error("Les dimensions de l'image doivent \xEAtre comprises entre 600x600 et 2048x2048 pixels");if(Ve)throw new Error("La taille de l'image ne doit pas d\xE9passer 2000 Ko");let k=new FileReader;k.onload=()=>{let R=k.result;this.imagePreview=R,this.postForm.patchValue({image_b64:R.slice(R.indexOf(",")+1)})},k.readAsDataURL(S)}catch(U){this.utils.alert(U.message,I.ERROR)}}}}submitPost(){return J(this,null,function*(){this.forms.checkFormValidity(this.postForm)&&(yield this.posts.createPost(this.postForm.value).then(()=>(this.utils.alert("Post cr\xE9\xE9 avec succ\xE8s",I.SUCCESS),this.utils.playSound(Se.POST),!0)).catch(o=>(this.utils.alert(o.error.error,I.ERROR),!1)))&&(this.postForm.reset(),this.imagePreview=void 0,this.postCreated.emit())})}};e.\u0275fac=function(o){return new(o||e)(f(W),f(Pe),f(De),f(F))},e.\u0275cmp=C({type:e,selectors:[["app-post-form"]],outputs:{postCreated:"postCreated"},decls:12,vars:3,consts:[[1,"bg-white","p-4","rounded-lg","shadow-md","w-full","mb-4",3,"formGroup","ngSubmit"],[1,"font-semibold","mb-2"],[1,"mb-4"],["name","content","placeholder","Quoi de neuf ?",1,"textarea","w-full","mb-3","h-32",3,"formControl"],["class","w-48 h-48 rounded-lg mx-auto my-2 aspect-square","alt","Uploaded Image",3,"src"],[1,"flex","justify-end","space-x-2","text-gray-400"],[1,"flex","btn","btn-ghost","btn-circle","cursor-pointer"],[1,"bi","bi-camera","text-xl"],["accept","image/png, image/jpeg, image/jpg, image/gif","name","image","type","file",1,"hidden",3,"change"],["type","submit",1,"btn","btn-primary","btn-circle"],[1,"bi","bi-send-fill","text-lg"],["alt","Uploaded Image",1,"w-48","h-48","rounded-lg","mx-auto","my-2","aspect-square",3,"src"]],template:function(o,r){o&1&&(l(0,"form",0),x("ngSubmit",function(){return r.submitPost()}),l(1,"h1",1),d(2,"Nouvelle publication"),a(),p(3,"hr",2)(4,"textarea",3),y(5,et,1,1,"img",4),l(6,"div",5)(7,"label",6),p(8,"i",7),l(9,"input",8),x("change",function(m){return r.onImagePicked(m)}),a()(),l(10,"button",9),p(11,"i",10),a()()()),o&2&&(g("formGroup",r.postForm),c(4),g("formControl",r.content),c(),T(5,r.imagePreview?5:-1))},dependencies:[xe,Ce,ye,Te,be,_e]});let t=e;return t})();function it(t,e,n,i){let o=window&&!!window.document&&window.document.documentElement,r=o&&e?window:n;if(t&&(r=t&&o&&typeof t=="string"?ot(t,n.nativeElement,i):t,!r))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return r}function ot(t,e,n){return(n?window.document:e).querySelector(t)}function V(t){return t&&!t.firstChange}function nt(){return typeof window<"u"}var rt={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},st={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"},X=class{constructor(e=!0){this.vertical=e,this.propsMap=e?rt:st}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}};function lt(t,e,n){return!!(t&&e||!n&&e)}function at({windowElement:t,axis:e}){return ct({axis:e,isWindow:pt(t)},t)}function ct(t,e){let n=t.isWindow||e&&!e.nativeElement?e:e.nativeElement;return q($({},t),{container:n})}function pt(t){return["Window","global"].some(n=>Object.prototype.toString.call(t).includes(n))}function Z(t,e){return t?e.document.documentElement:null}function We(t,e){let n=ft(e);return e.isWindow?dt(n,t,e):mt(n,t,e)}function dt(t,e,n){let{axis:i,container:o,isWindow:r}=n,{offsetHeightKey:s,clientHeightKey:m}=je(i),h=t+ke(Z(r,o),i,r),u=Ue(e.nativeElement,r,s,m),S=ut(e.nativeElement,i,r)+u;return{height:t,scrolled:h,totalToScroll:S,isWindow:r}}function mt(t,e,n){let{axis:i,container:o}=n,r=o[i.scrollTopKey()],s=o[i.scrollHeightKey()];return{height:t,scrolled:r,totalToScroll:s,isWindow:!1}}function je(t){return{offsetHeightKey:t.offsetHeightKey(),clientHeightKey:t.clientHeightKey()}}function ft({container:t,isWindow:e,axis:n}){let{offsetHeightKey:i,clientHeightKey:o}=je(n);return Ue(t,e,i,o)}function Ue(t,e,n,i){if(isNaN(t[n])){let o=Z(e,t);return o?o[i]:0}else return t[n]}function ut(t,e,n){let i=e.topKey();if(t.getBoundingClientRect)return t.getBoundingClientRect()[i]+ke(t,e,n)}function ke(t,e,n){let i=e.pageYOffsetKey(),o=e.scrollTopKey(),r=e.offsetTopKey();return isNaN(window.pageYOffset)?Z(n,t)[o]:t.ownerDocument?t.ownerDocument.defaultView[i]:t[r]}function ht(t,e={down:0,up:0},n){let i,o;if(t.totalToScroll<=0)return!1;let r=t.isWindow?t.scrolled:t.height+t.scrolled;if(n)i=(t.totalToScroll-r)/t.totalToScroll,o=(e?.down?e.down:0)/10;else{let m=t.scrolled+(t.totalToScroll-r);i=t.scrolled/m,o=(e?.up?e.up:0)/10}return i<=o}function gt(t,e){return t<e.scrolled}function vt(t,e,n){let i=gt(t,e);return{fire:ht(e,n,i),scrollDown:i}}var Y=class{constructor(e){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},Object.assign(this,e)}updateScrollPosition(e){return this.lastScrollPosition=e}updateTotalToScroll(e){this.lastTotalToScroll!==e&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=e)}updateScroll(e,n){this.updateScrollPosition(e),this.updateTotalToScroll(n)}updateTriggeredFlag(e,n){n?this.triggered.down=e:this.triggered.up=e}isTriggeredScroll(e,n){return n?this.triggered.down===e:this.triggered.up===e}};function St(t){let{scrollContainer:e,scrollWindow:n,element:i,fromRoot:o}=t,r=at({axis:new X(!t.horizontal),windowElement:it(e,n,i,o)}),s=new Y({totalToScroll:We(i,r).totalToScroll}),m={container:r.container,throttle:t.throttle},h={up:t.upDistance,down:t.downDistance};return wt(m).pipe(ee(()=>Q(We(i,r))),K(u=>Ct(s.lastScrollPosition,u,h)),A(({stats:u})=>s.updateScroll(u.scrolled,u.totalToScroll)),ie(({fire:u,scrollDown:S,stats:{totalToScroll:w}})=>lt(t.alwaysCallback,u,s.isTriggeredScroll(w,S))),A(({scrollDown:u,stats:{totalToScroll:S}})=>{s.updateTriggeredFlag(S,u)}),K(yt))}function wt(t){let e=te(t.container,"scroll");return t.throttle&&(e=e.pipe(oe(t.throttle,void 0,{leading:!0,trailing:!0}))),e}function Ct(t,e,n){let{scrollDown:i,fire:o}=vt(t,e,n);return{scrollDown:i,fire:o,stats:e}}var B={DOWN:"[NGX_ISE] DOWN",UP:"[NGX_ISE] UP"};function yt(t){let{scrollDown:e,stats:{scrolled:n}}=t;return{type:e?B.DOWN:B.UP,payload:{currentScrollPosition:n}}}var Re=(()=>{let e=class e{constructor(i,o){this.element=i,this.zone=o,this.scrolled=new H,this.scrolledUp=new H,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:i,infiniteScrollDisabled:o,infiniteScrollDistance:r}){let s=V(i),m=V(o),h=V(r),u=!m&&!this.infiniteScrollDisabled||m&&!o.currentValue||h;(s||m||h)&&(this.destroyScroller(),u&&this.setup())}setup(){nt()&&this.zone.runOutsideAngular(()=>{this.disposeScroller=St({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(i=>this.handleOnScroll(i))})}handleOnScroll({type:i,payload:o}){let r=i===B.DOWN?this.scrolled:this.scrolledUp;Tt(r)&&this.zone.run(()=>r.emit(o))}ngOnDestroy(){this.destroyScroller()}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}};e.\u0275fac=function(o){return new(o||e)(f(pe),f(de))},e.\u0275dir=re({type:e,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[se]});let t=e;return t})();function Tt(t){return t.observed??t.observers.length>0}var Ke=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=P({type:e}),e.\u0275inj=_({});let t=e;return t})();var bt=(t,e)=>e.post_id;function _t(t,e){if(t&1&&(l(0,"h3",14),d(1),a(),l(2,"span",5),d(3),a()),t&2){let n=v().$implicit;c(),N("",n.profile.user.first_name," ",n.profile.user.last_name,""),c(2),E(n.profile.user.title)}}function Pt(t,e){if(t&1&&(l(0,"h3",14),d(1),a(),l(2,"span",5),d(3),a()),t&2){let n=v().$implicit;c(),E(n.profile.user.company_name),c(2),E(n.profile.user.sector)}}function Et(t,e){t&1&&(l(0,"div",15)(1,"div",16),p(2,"div",17),l(3,"div",18),p(4,"div",19)(5,"div",20),a()(),p(6,"div",21),a())}function It(t,e){if(t&1&&(l(0,"div",1)(1,"div",2),p(2,"img",3),l(3,"div",4),y(4,_t,4,3)(5,Pt,4,2),l(6,"p",5),d(7),a(),l(8,"p",6),d(9),a(),l(10,"div",7),p(11,"img",8),a()()(),l(12,"div",9)(13,"div",10)(14,"span",11),p(15,"i",12),a(),l(16,"span",11),d(17,"Commenter"),a(),l(18,"span",11),d(19,"Envoyer"),a()()()(),y(20,Et,7,0,"div",13)),t&2){let n=e.$implicit,i=v();c(2),g("appSrc",n.profile.user.imageName),c(2),T(4,i.users.isJobseeker(n.profile.user)||i.users.isAdmin(n.profile.user)?4:i.users.isCompany(n.profile.user)?5:-1),c(3),E(i.utils.formatDate(n.created,!0)),c(2),E(n.description),c(2),g("appSrc",n.imageName),c(9),T(20,i.isLoading?20:-1)}}var Ae=(()=>{let e=class e{constructor(i,o,r){this.postsService=i,this.utils=o,this.users=r,this.posts=[],this.current_page=0,this.size=10,this.isLoading=!1,this.loadPosts()}loadPosts(){this.isLoading=!0,this.postsService.getPosts(this.current_page,this.size,"created,desc").then(i=>{this.posts=this.posts.concat(i.content),this.current_page++,this.isLoading=!1}).catch(i=>{this.utils.alert("Error loading posts",I.ERROR),this.isLoading=!1})}onScroll(){this.isLoading||this.loadPosts()}onPostCreated(){this.posts=[],this.current_page=0,this.loadPosts()}};e.\u0275fac=function(o){return new(o||e)(f(F),f(W),f(D))},e.\u0275cmp=C({type:e,selectors:[["app-posts-feed"]],decls:3,vars:2,consts:[["infiniteScroll","",3,"infiniteScrollDistance","infiniteScrollThrottle","scrolled"],[1,"bg-white","p-4","rounded-lg","shadow","mb-2"],[1,"flex","items-start","mb-2"],["alt","Profile",1,"w-12","h-12","rounded-full","mr-4",3,"appSrc"],[1,"w-full"],[1,"text-sm","text-gray-500","leading-none"],[1,"my-4"],[1,"relative","my-2"],["alt","Post image","loading","lazy",1,"w-full","h-full","object-cover",3,"appSrc"],[1,"mt-4","flex","justify-between","text-gray-600","text-sm"],[1,"flex","space-x-2"],[1,"cursor-pointer"],[1,"bi","bi-hand-thumbs-up-fill"],["class","flex w-full flex-col gap-4"],[1,"text-lg","font-semibold","leading-none"],[1,"flex","w-full","flex-col","gap-4"],[1,"flex","items-center","gap-4"],[1,"skeleton","h-16","w-16","shrink-0","rounded-full"],[1,"flex","flex-col","gap-4"],[1,"skeleton","h-4","w-20"],[1,"skeleton","h-4","w-28"],[1,"skeleton","h-32","w-full"]],template:function(o,r){o&1&&(l(0,"div",0),x("scrolled",function(){return r.onScroll()}),me(1,It,21,6,null,null,bt),a()),o&2&&(g("infiniteScrollDistance",5)("infiniteScrollThrottle",50),c(),fe(r.posts))},dependencies:[j,Re]});let t=e;return t})();var ze=(()=>{let e=class e{constructor(i){this.users=i}ngOnInit(){this.users.currentUser.subscribe(i=>{i&&(this.user=i)})}};e.\u0275fac=function(o){return new(o||e)(f(D))},e.\u0275cmp=C({type:e,selectors:[["app-feed"]],decls:7,vars:1,consts:[[1,"mx-auto","p-4","flex","gap-6","w-3/4"],[1,"w-3/4"],[3,"postCreated"],["postsFeed",""],[1,"w-1/4","space-y-4"],[3,"user"]],template:function(o,r){if(o&1){let s=ue();l(0,"div",0)(1,"div",1)(2,"app-post-form",2),x("postCreated",function(){le(s);let h=he(4);return ae(h.onPostCreated())}),a(),p(3,"app-posts-feed",null,3),a(),l(5,"div",4),p(6,"app-profile-overview",5),a()()}o&2&&(c(6),g("user",r.user))},dependencies:[Me,Ne,Ae]});let t=e;return t})();var Ft=[{path:"",children:[{path:"",redirectTo:"feed",pathMatch:"full"},{path:"feed",component:ze,title:"Fil d'actualit\xE9 - LinkedOut"}]}],Le=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=P({type:e}),e.\u0275inj=_({imports:[L.forChild(Ft),L]});let t=e;return t})();var vi=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=P({type:e}),e.\u0275inj=_({providers:[F],imports:[ge,Le,Ee,Ie,Fe,Ke]});let t=e;return t})();export{vi as SocialModule};
