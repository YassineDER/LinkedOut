import{C as l,F as p,g as n,hb as c,j as o,r as u,w as a,zb as h}from"./chunk-YQE6JNPI.js";var g=(()=>{let r=class r{constructor(t){this.http=t,this.userSubject=new n(null),this.url=h.hostUrl+"/api/auth"}get user(){return this.userSubject.asObservable()}getAuthenticatedUser(){return this.checkAuthStatus().pipe(a(t=>(this.userSubject.next(t),o(t))),u(()=>(this.logout(),o(null))))}login(t){return new Promise((e,s)=>{this.http.post(this.url+"/authenticate",t).subscribe(this.handleAuthResponse(e,s))})}logout(){localStorage.removeItem("token"),this.userSubject.next(null),window.location.reload()}register(t,e){return new Promise((s,b)=>{this.http.post(this.url+"/register/"+e.toLowerCase(),t).subscribe(this.handleAuthResponse(s,b))})}verifyEmail(t){return new Promise((e,s)=>{this.http.get(this.url+"/verify/"+t).subscribe(this.handleAuthResponse(e,s))})}resetPassword(t){return new Promise((e,s)=>{this.http.post(this.url+"/verify/password",t).subscribe(this.handleAuthResponse(e,s))})}requestPasswordReset(t){return new Promise((e,s)=>{this.http.post(this.url+"/reset-password",t).subscribe(this.handleAuthResponse(e,s))})}checkAuthStatus(){return this.http.get(h.hostUrl+"/api/user/status/v2")}handleAuthResponse(t,e){return{next:s=>t(s),error:s=>e(s)}}simulateLongRequest(){return new Promise((t,e)=>{this.http.get(this.url+"/sleep").subscribe(this.handleAuthResponse(t,e))})}};r.\u0275fac=function(e){return new(e||r)(p(c))},r.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();export{g as a};
